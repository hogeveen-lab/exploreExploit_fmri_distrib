function [ba_wa_nov_tskobj] = novelty_choice_reclassify(choice,picid,Qsa,reward)

ntrls = size(choice,1);

bwnto = [-999 -999 -999];

ndropins = 0;
toloc = [1 2 3];

fnt = min(find(sum(picid,2)>0));

nsamp = [0 0 0];
nrew = [0 0 0];

for m = 1:ntrls
%     disp('f');
%     disp(m);
%     disp('f');
    if m<fnt
        if max(nsamp)==0
            tmp = randperm(3);
            nov = tmp(1);
            ba = tmp(2);
            wa = tmp(3);
            bwnto(m,:) = [ba wa nov];
            %disp([ba wa nov]);
            nsamp(choice(m,1)) = nsamp(choice(m,1))+1;
            nrew(choice(m,1)) = nrew(choice(m,1))+reward(m,1);
        
        elseif max(size(find(nsamp==min(nsamp))))>1
            nexp = (nrew+1)./(nsamp+2);
            vn = find(nsamp==min(nsamp));
            va = find(nsamp~=min(nsamp));
            onov = find(abs(nexp(vn)-.5)==min(abs(nexp(vn)-.5)));
            onov = vn(onov);
            %nov
            %size(nov)
            %max(size(onov))
            if max(size(onov))>1
                pni = randperm(max(size(onov)));
                %pni
                nov = onov(pni(1));
                wa = onov(pni(2));
            else
                nov = onov;
                wa = [1 2 3];
                wa = min(wa(wa~=nov & nexp==min(nexp(wa~=nov))));
            end;
            if max(size(vn))==2
                ba = va;
            elseif max(size(vn))==3
                %disp(['N',num2str(nov)]);
                %disp(['W',num2str(wa)]);
                ba = [1 2 3];
                ba = ba(ba~=nov & ba~=wa);
            end;
            %disp(ba);
            %[ba wa nov]
            bwnto(m,:) = [ba wa nov];
            %disp([ba wa nov]);
            nsamp(choice(m,1)) = nsamp(choice(m,1))+1;
            nrew(choice(m,1)) = nrew(choice(m,1))+reward(m,1);
        else
            nexp = (nrew+1)./(nsamp+2);
            nov = find(nsamp==min(nsamp));
            wa = [1 2 3];
            wa = min(wa(wa~=nov & nexp==min(nexp(wa~=nov))));
            ba = [1 2 3];
            ba = ba(ba~=nov & ba~=wa);
            %wa = wa(wa~=nov);
            %ba = find(nexp==max(nexp));
            %disp([ba wa nov]);
            bwnto(m,:) = [ba wa nov];
            nsamp(choice(m,1)) = nsamp(choice(m,1))+1;
            nrew(choice(m,1)) = nrew(choice(m,1))+reward(m,1);
        end;
    end;

    if sum(picid(m,:),2)==1,
        ndropins=ndropins+1;
        novto = find(picid(m,:)==1);
    end;
    
    if ndropins>0
        
        bwl = toloc(toloc~=novto);
        bwlQsa = Qsa(m,bwl);
        
        if bwlQsa(1,1) > bwlQsa(1,2)
                bwnto(m,1) = bwl(1);
                bwnto(m,2) = bwl(2);
        elseif bwlQsa(1,1) < bwlQsa(1,2)
                bwnto(m,1) = bwl(2);
                bwnto(m,2) = bwl(1); 
        elseif bwlQsa(1,1) == bwlQsa(1,2)
                db=1;
                fprintf('.\t');
                while sum(bwlQsa(1,1) == bwlQsa(1,2))==1
                    bwlQsa = Qsa(h-db,bwl);
                    db = db+1;
                    if (h-db)<=0, bwlQsa = bwlQsa+rand(1,2); break; end;
                end;
                if bwlQsa(1,1) > bwlQsa(1,2)
                    bwnto(m,1) = bwl(1);
                    bwnto(m,2) = bwl(2);
                elseif bwlQsa(1,1) < bwlQsa(1,2)
                    bwnto(m,1) = bwl(2);
                    bwnto(m,2) = bwl(1);
                end;
        end;
        clear bwlQsa;
        clear db;
        clear bwl;
        
        bwnto(m,3) = novto;
        
    else
        
        %bwnto(m,:) = [-999 -999 -999];
        
    end;
    
end;

ba_wa_nov_tskobj = bwnto; clear bwnto;
               
        
        
    
    
        
        
    
    
    
    
